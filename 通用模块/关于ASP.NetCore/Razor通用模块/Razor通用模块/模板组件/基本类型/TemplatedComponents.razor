@namespace Microsoft.AspNetCore.Components
@using Microsoft.AspNetCore.Components.Services
@using Microsoft.JSInterop

@Template?.Invoke(this)

@code
{
    //这个类型表示一个模板化组件，它的呈现方式由可替换的组件模板来实现

#pragma warning disable CS8618, CS8603
    #region 有关组件模板
    #region 模板属性
    private RenderFragment<TemplatedComponents>? TemplateField;
    /// <summary>
    /// 获取或设置组件的模板，它决定组件如何呈现，
    /// 该模板是一个委托，它的参数就是这个组件本身
    /// </summary>
    [Parameter]
    public RenderFragment<TemplatedComponents> Template
    {
        get => TemplateField;
        set
        {
            TemplateField = value ?? throw new ArgumentNullException($"不能将组件模板赋值为null");
            StateHasChanged();
        }
    }
    #endregion
    #region 依赖注入IProvidedDefaultTemplate
    /// <summary>
    /// 这个属性可以为组件提供默认模板和项模板
    /// </summary>
    [Inject]
    protected IProvidedDefaultTemplate ProvidedDefaultTemplate { get; set; }
    #endregion
    #endregion
    #region 依赖注入IJSRuntime
    /// <summary>
    /// 这个属性提供了进行JS互操作的能力
    /// </summary>
    [Inject]
    public IJSRuntime JSRuntime { get; set; }
    #endregion
    #region 重写OnInitialized
    protected override void OnInitialized()
    {
        TemplateField ??= ProvidedDefaultTemplate.GetTemplate(this.GetType());
    }
    #endregion
}
